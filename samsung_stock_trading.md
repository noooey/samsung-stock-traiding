# 삼성전자 주식의 매매 결정 모델(GRU)

## 목적
전일 대비 종가 변화 5일치로 그 다음주 5일의 삼성전자 주식 매매 결정하는 모델  
`['2022-02-14', '2022-02-15', '2022-02-16', '2022-02-17', '2022-02-18']` 최종 예측

***

## 데이터
금융 데이터 수집 라이브러리 [FinanceDataReader](https://financedata.github.io/posts/finance-data-reader-users-guide.html)의 데이터 사용

***

## EDA
- 단순 plot으로 삼성전자의 주가 변동성 확인 -> 코로나로 인한 폭락 시점 이후 6월 쯤부터로 데이터 셋 형성하기로 결정
- 각종 변수들의 상관관계 분석
- 밀도 확인
- 사분위수로 이상치 확인
- 분포도 확인 -> 분포의 왜도가 심했던 변수들은 로그변환
- 결론적으로 사용하지 않을 변수들 제거

***

## 전처리
- 시작 날짜, 끝나는 날짜를 지정해주고 DataReader로 각종 금융 변수들을 불러와 데이터셋 생성
- 미국은 시차가 있으므로 미국 지수는 하루씩 미뤄준 후 null값을 채워줌
- 공통적으로 null값이 존재하는 공휴일 및 주식장 휴일 list drop
- 나머지 null값들은 이전값으로 채워줌
- 10일 이동 평균 추가 `ma10`, 볼린저 밴드 추가 `bb`
- 변수 스케일링 -> 음수 포함된 변수들만 따로 데이터셋 형성해 정규화, 나머지들은 따로 데이터셋 형성해 정규화 -> 둘이 concat

***

## 모델링
### GRU 모델 이용  
![image](https://user-images.githubusercontent.com/66217855/156397875-3d96d521-f7b7-4ac4-a238-297c59436302.png)  

이진 분류이기 때문에 마지막 출력 뉴런은 1개, 활성함수는 sigmoid 사용

***

## 학습
early stopping이나 check point 등 콜백함수를 따로 사용하지 않고  
에포크를 충분하게 주어 학습을 한 번 진행해보고  
오버피팅이 나는 부분을 체크한 후  
오버피팅이 나기 직전까지만 다시 학습을 진행하여 모델을 완성함  
✔️  조기종료 시 학습을 더 할 수 있음에도 불구하고 일찍 학습이 종료되는 문제가 있음

***

## 성능평가
평가지표로 F1 score, accuracy 사용  
✔️ 이진분류의 평가 지표를 accuracy 하나만으로 하기에는 적절하지 않다.

F1 Score 0.98까지  
Accuracy 0.98까지  
성능 도출

***

## 다음 과제...
✔️ 
✔️ 데이터를 엄청 많이 준비해야할 것 같다   
✔️ 데이터 전처리, EDA를 많이 연습해봐야겠다    
✔️ 종가만 비교하는게 아닌 하루 내에서도 주가의 상승 하락에 따라 실시간으로 매매 여부를 결정해보기  
✔️ 변화량이나 변화율을 계산하여 수익률까지 계산해보기  
✔️ 주식 매매봇을 아예 만들어보자  

